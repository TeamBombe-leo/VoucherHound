<!DOCTYPE html>
<html>
   <head>
      <title>Voucher Hound</title>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="stylesheet" href="stylesheets/style.css">
      <script src="js/h5utils.js"></script>
   </head>
   <body>
      <div id="bodyContent">
         <img class = "newappIconWelcome" src="images/hound_dog_logo.png">
         <div id="welcomeContent">
            <h3>Finding your location: <span id="status">checking...</span></h3>
         </div>
         <article>
         </article>
      </div>
      <script type="text/javascript" src="http://maps.apple.com/maps/api/js?sensor=false"></script>
      <script>
         function success(position) {
           var s = document.querySelector('#status');
           
           if (s.className == 'success') {
             // not sure why we're hitting this twice in FF, I think it's to do with a cached result coming back    
             return;
           }
           
           s.innerHTML = "found you!";
           s.className = 'success';
           
           var mapcanvas = document.createElement('div');
           mapcanvas.id = 'mapcanvas';
           mapcanvas.style.height = '400px';
           mapcanvas.style.width = '560px';
             
           document.querySelector('article').appendChild(mapcanvas);
           
           var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
           var myOptions = {
             zoom: 15,
             center: latlng,
             mapTypeControl: false,
             navigationControlOptions: {style: google.maps.NavigationControlStyle.SMALL},
             mapTypeId: google.maps.MapTypeId.ROADMAP
           };
           var map = new google.maps.Map(document.getElementById("mapcanvas"), myOptions);
           
           var marker = new google.maps.Marker({
               position: latlng, 
               map: map, 
               title:"You are here! (at least within a "+position.coords.accuracy+" meter radius)"
           });
         }
         
         function error(msg) {
           var s = document.querySelector('#status');
           s.innerHTML = typeof msg == 'string' ? msg : "failed";
           s.className = 'fail';
           
           // console.log(arguments);
         }
         
         if (navigator.geolocation) {
           navigator.geolocation.getCurrentPosition(success, error);
         } else {
           error('not supported');
         }
         
      </script>
      </section>
      <script src="js/prettify.packed.js"></script>
      <script>
         var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
         document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
      </script>
      <script>
         try {
         var pageTracker = _gat._getTracker("UA-1656750-18");
         pageTracker._trackPageview();
         } catch(err) {}
      </script>
   </body>
</html>